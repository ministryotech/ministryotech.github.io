


<!doctype html>
<html class="no-js" lang="en">

<!-- Mirrored from www.minotech.co.uk/development/blog/extension-methods-in-net-20-net-35/ by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 06 Jan 2021 11:31:13 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <script>
        // Pure JavaScript 'JS enabled' hook for styling
        var _ = document.getElementsByTagName('html')[0];
        _.className = _.className.replace(/(?:^|\s)no-js(?!\S)/g, 'js');
    </script>

    <meta charset="utf-8" />
    <title>Extension Methods in .net 2.0 &amp; .net 3.5 - The Ministry of Technology</title>
    <meta name="description" content="Holistic Technical Counsel - Agile Software Development & Management with a difference" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- Icons -->
    <link rel="shortcut icon" href="../../../images/ministry/favicon.ico" />
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../../../images/ministry/apple-touch-icon-114x114-precomposed9078.png?v=7.1.0.25803" />
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../../../images/ministry/apple-touch-icon-72x72-precomposed9078.png?v=7.1.0.25803" />
    <link rel="apple-touch-icon-precomposed" href="../../../images/ministry/apple-touch-icon-precomposed9078.png?v=7.1.0.25803" />
    <!-- Core styles -->
    <link rel="stylesheet" href="../../../3rd-party/maxcdn.bootstrapcdn.com/font-awesome/4.6.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="../../../css/development-style.min91af.css?v=7.1.0.25813" />
    <!-- References -->
    <link rel="author" href="../../../humans.txt" />

    <!-- Scripts to execute before page load begins -->
    <script src="../../../3rd-party/use.typekit.net/sha1jar.js"></script>
    <script>try { Typekit.load(); } catch (e) { }</script>
</head>
<body class="dev-body">
    <div class="wide-bg">
        <img src="../../../images/development/background9078.svg?v=7.1.0.25803" alt="" />
    </div>
    <div class="outer">
        <header>
            <a href="../../../developers/index.html" title="Ministry of Technology"><img class="brand-heading" src="../../../images/development/logo-text9078.svg?v=7.1.0.25803" alt="Ministry of Technology" /></a>
            <!--[if IE]><p>This site is optimised for HTML5 and CSS3 and is not supported by IE9 or lower. <a href="http://browsehappy.com/">Upgrade to a different browser</a> to experience this site.</p><![endif]-->
<i class="menu-button fa fa-bars"></i>
<nav id="js-nav" class="bp-wide">
    <ul>
                <li><a href="../../../index.html">Home</a></li>                <li><a href="../../index.html">Development</a></li>                <li><a href="../../mentoring/index.html">Mentoring</a></li>                <li><a class="selected" href="../index.html">Blog</a></li>                <li><a href="../../open-source-projects/index.html">Open Source</a></li>                <li><a href="../../../contact/index.html">Contact</a></li>    </ul>
</nav>        </header>
        <!--[if gt IE 9]><!-->
        <div class="inner">
            <section class="page-title-or-logo">
                    <h1> Extension Methods in .net 2.0 &amp; .net 3.5 </h1>
                                    <section class="subdata">
                        
    <span class="article-metadata article-metadata--heavy"><i class="article-metadata__icon fa fa-pencil"></i>By <a href="../../../network/keith-jackson/index.html">Keith Jackson</a> <i class="article-metadata__separator fa fa-circle"></i> 28/10/2008</span>
    
                    </section>
            </section>
            <img class="mobile-fold" src="../../../images/development/background9078.svg?v=7.1.0.25803" alt="Show Menu" />
            <div class="block-container ">
                    <section class="element-block element-block--intro element-block--title">
                        <div class="element-block__content">
                            <h1> Extension Methods in .net 2.0 &amp; .net 3.5 </h1>
                                <section class="subdata">
                                    
    <span class="article-metadata article-metadata--heavy"><i class="article-metadata__icon fa fa-pencil"></i>By <a href="../../../network/keith-jackson/index.html">Keith Jackson</a> <i class="article-metadata__separator fa fa-circle"></i> 28/10/2008</span>
    
                                </section>
                        </div>
                    </section>
                



<div class="main-strip">
    <section class="element-block element-block--main">
        <article class="element-block__content">
    <p>I discovered a very interesting trick while working on the extension method libraries for the MOT Framework Extensions project. This allowed you to create an assembly which supported extension methods in .net 2.0, using the 'System.Runtime.CompilerServices' hack, but also have that assembly run in .net 3.5 (and presumably 4.0 as well although at the time of rewriting I haven't tested this). Here's the simple how-to guide for building an assembly with extension methods to run on .net 2.0 (SP1) or 3.5...</p>
<ol>
<li>Create a class file and add the following code to simulate the extension method attribute (this has been repeated on so many blogs now I can't remember who discovered this one first but Daniel Moth seems to be the favourite - <a href="http://www.danielmoth.com/Blog/2007/05/using-extension-methods-in-fx-20.html">http://www.danielmoth.com/Blog/2007/05/using-extension-methods-in-fx-20.html</a>). The #if statements are important to the switching.
<pre>namespace System.Runtime.CompilerServices
{
  #if Fr20
    [AttributeUsage(AttributeTargets.Method AttributeTargets.Assembly AttributeTargets.Class)]
    public sealed class ExtensionAttribute : Attribute
    { }
  #endif
}
</pre>
</li>
<li>Add a simple extension method in a static class to check that the assembly is building.</li>
<li>Assuming you are intially compiling for .net 2.0, make sure that '.NET Framework 2.0' is selected as the Target Framework entry in the project properties. You also need to then go to the 'Build' section in properties and enter 'Fr20' in the 'Conditional compliation symbols' box.</li>
</ol>
<p>Your assembly should now compile fine for .net 2.0, but what about 3.5...</p>
<ol>
<li>Making sure you have saved everything, switch the Target Framework to 3.5 in the project properties section.</li>
<li>Remove the 'Fr20' entry from Conditional compilation symbols.</li>
<li>If you try to build now compilation will fail. We have one more step to complete; add a reference to System.Core (This contains the Extension attribute data for the .net Framework 3.5)</li>
</ol>
<p>Your assembly should now compile fine for 3.5. To switch back to 2.0, simply change the Target Framework entry back to 2.0 and re-add 'Fr20' to the Conditional compilation symbols. You don't need to worry about the references to System.Core, that will be dropped and added automatically from this point on as you switch your target framework.</p>
<p>If you have any other framework specific code you with to include or exclude you can then use the #if Fr20 bracket in the same way to exclude 3.5 functionality that, for whatever reason, you need to manually replicate in 2.0.</p>
<p>(By the way, it doesn't have to be #if Fr20, it is a simple conditional compilation directive and you could make it #if GreenSheep if you really wanted to!)</p>
</article>
        <footer class="element-block__footer">
                <a href="../aspnet-application-targetting-net-20-does-not-build-but-shows-no-errors/index.html">
        <i class="post-icon fa fa-arrow-right"></i>
        <span class="element-block__footer__link-text element-block__footer__link-text--right">Next Article</span>
    </a>

        </footer>
    </section>
    <section class="element-block element-block--main">
        <div id="disqus_thread" class="element-block__content element-block__content--no-footer"></div>
    </section>
</div>
<nav class="sidebar sidebar--articles-selector">
            <h1><i class="pre-icon fa fa-file-text"></i> <a href="../index.html">Latest Entries</a></h1>
    <ul>
                <li><a href="../the-pylon-is-live/index.html">The Pylon is Live</a></li>
                <li><a href="../umbraco-published-content-seems-wrong/index.html">Umbraco Published Content seems wrong</a></li>
                <li><a href="../open-source-products-refreshed/index.html">Open Source Products - Refreshed</a></li>
                <li><a href="../testing-web-api-routes-with-ministry-open-source/index.html">Testing Web API Routes with Ministry Open Source</a></li>
                <li><a href="../azure-umbraco-friends-at-last/index.html">Azure &amp; Umbraco - Friends at Last?</a></li>
                <li><a href="../entity-framework-repositories-now-on-nuget/index.html">Entity Framework Repositories - now on nuget</a></li>
                <li><a href="../azure-not-a-lean-solution/index.html">Azure - Not a lean solution</a></li>
                <li><a href="../migrating-umbraco-5-to-umbraco-411/index.html">Migrating Umbraco 5 to Umbraco 4.11</a></li>
                <li><a href="../testing-mvc-routes-with-ministry-open-source/index.html">Testing MVC Routes with Ministry Open Source</a></li>
                <li><a href="../detecting-touch-devices/index.html">Detecting Touch Devices</a></li>

    </ul>

</nav>
<script type="text/javascript">
    var disqus_identifier = 'www.minotech.co.uk-article-1086';
    var disqus_title = 'Extension Methods in .net 2.0 &amp; .net 3.5';
    var disqus_url = 'index.html';
</script>

            </div>
        </div>
        <footer class="brand-footer">
            <div class="brand-footer__notes">
                <p class="brand-footer__copyright"><i class="fa fa-copyright"></i> 2021 Keith Jackson (The Ministry of Technology)</p>
                <p class="brand-footer__strapline">
                    Pragmatic Agile Coaching & Consultancy, Software Development & Technical Architecture - Web, Cloud, Apps & Agile for
                    an Alternative audience.
                </p>
                <p class="brand-footer__links">
                    <a href="../../../elements/privacy-policy.html">Privacy Policy</a>
                    &nbsp;|&nbsp;
                    <a href="../../../elements/cookies-policy.html">Cookies Policy</a>
                    &nbsp;|&nbsp;
                    <a href="../../../elements/terms-and-conditions.html">Terms & Conditions</a>
                </p>
            </div>
            <aside class="brand-footer__logos">
                <section class="logos">
    <div class="logos__social">
        <a href="https://www.linkedin.com/company/the-ministry-of-technology/" target="_blank">
            <i class="logos__logo logos__social__logo logos__logo--linkedin fa fa-linkedin"></i>
        </a>
        <a href="https://twitter.com/ministryotech" target="_blank">
            <i class="logos__logo logos__social__logo logos__logo--twitter fa fa-twitter"></i>
        </a>
        <a href="https://www.instagram.com/agilerodent/" target="_blank">
            <i class="logos__logo logos__social__logo logos__logo--instagram fa fa-instagram"></i>
        </a>
    </div>
</section>
            </aside>
        </footer>
        <!--<![endif]-->
        <div class="clear"></div>
    </div>
    <script src="../../../js/head-1.0.3.min.js"></script>
    <script>
        head.js(
'../../../3rd-party/ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js',
'../../../js/ministry.min91af.js?v=7.1.0.25813',
'../../../js/analytics91af.js?v=7.1.0.25813'
);

    </script>
</body>

<!-- Mirrored from www.minotech.co.uk/development/blog/extension-methods-in-net-20-net-35/ by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 06 Jan 2021 11:31:13 GMT -->
</html>